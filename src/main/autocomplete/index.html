<!DOCTYPE html>
<html>
<head>
    <title>Persoo Autocomplete</title>

    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- jQuery + Twitter Bootstrap + Persoo Playground Navigations + etc -->
    <link href="../img/favicon.png" rel="icon" type="image/png">
    <link href="../../common/persoo-demo-all.css" rel="stylesheet" media="screen">
    <script src="../../common/persoo-demo-all.js" type="text/javascript"></script>
    <script>
        // just for developement before release to production
        QueryString.persooAccountID = 'gq1keovbie8gikia919g9ou2';
        QueryString.persooScriptsHostname = '//s3-eu-west-1.amazonaws.com/cz.persoo.test-a.javascripts/';
        QueryString.rtpHostname = 'rtp-test-a.persoo.cz';
    </script>
    <script src="../globalConfig.js" type="text/javascript"></script>

    <link href="style.css" rel="stylesheet" media="screen">

    <!-- styles for autocomplete -->
    <link rel="stylesheet" href="auto-complete.css">

    <!-- persooSolutionStart -->
    <script type='text/javascript'>
        var persooConfig = {
            apikey: persooAccountID, // variable from globalConfig.js
            persooName: 'persoo',
            dataLayerName: 'dataLayer', // we recommend to share dataLayer with GTM to measure new events to all systems
            scriptsHostname: persooScriptsHostname,
            settings_tolerance: 2000,  // for loading persoo.js
            personalizations_tolerance: 2500,    // for showing personalizations
        };

        /*! Persoo js client 2015-03-16 */
        var persooLoader=function(a,b,c,d,e){var f=d.persooName,g='_persoo_hide_body';return{hideBody:
        function(){var b=a.createElement('style'),c='body{opacity:0 !important;filter:alpha(opacity=0)'
        +' !important;background:none !important;}',d=a.getElementsByTagName('head')[0];b.setAttribute(
        'id',g),b.setAttribute('type','text/css'),b.styleSheet?b.styleSheet.cssText=c:b.appendChild(
        a.createTextNode(c)),d.appendChild(b)},finish:function(){if(!c){c=!0;var b=a.getElementById(g);b&&
        b.parentNode.removeChild(b)}},loadScript:function(b){var c=a.createElement('script');c.src=b,c.type
        ='text/javascript',c.onerror=function(){persooLoader.finish()},a.getElementsByTagName('head')[0
        ].appendChild(c)},init:function(){b[f]=b[f]||function(){(b[f].q=b[f].q||[]).push([].slice.call(
        arguments))},b[f].l=1*new Date,b[f].apikey=d.apikey,b[f].dataLayerName=d.dataLayerName;var c=
        a.cookie.match('(^|; )'+e+'=([^;]*)'),g=location.search.match('[?&]'+e+'=([^&]*)'),h=g?g[1]:c?c[2]:
        'p';d.settings_tolerance>0&&(setTimeout(this.finish,d.settings_tolerance),this.hideBody());var i=(
        d.scriptsHostname||'http://scripts.persoo.cz/')+d.apikey+'/'+h;this.loadScript(i+'/actions.js'),
        this.loadScript(i+'/persoo.js')}}}(document,window,!1,persooConfig,'persooEnvironment');persooLoader.init();
    </script>
    <!-- persooSolutionEnd -->

</head>
<body>
    <div class="container-fluid">
        <div class="row-fluid">
            <div class="col-md-2" id="localNavigation">
                <!--Sidebar content-->
            </div>
            <div class="col-md-10 content">
                <!--Body content-->
                <h1>Auto-complete</h1>


                <p>This demonstrates the auto-complete feature in Persoo. Create algorithm 
                </p>

                <h3>Pure suggest search signal</h3>
                <input id="demoAutocomplete1" autofocus="" type="text" name="q" placeholder="Search for product ..." style="width:100%;max-width:600px;outline:0;margin-top:2px;" autocomplete="off">

                <h3>Only search signal</h3>
                <input id="demoAutocomplete2" autofocus="" type="text" name="q" placeholder="Search for product ..." style="width:100%;max-width:600px;outline:0;margin-top:2px;" autocomplete="off">

                <h3>Persoalized by favourite color</h3>
                <p>Select color preferences below</p>
                <input id="demoAutocomplete3" autofocus="" type="text" name="q" placeholder="Search for product ..." style="width:100%;max-width:600px;outline:0;margin-top:2px;" autocomplete="off">

                

                <!-- Using https://goodies.pixabay.com/javascript/auto-complete/demo.html -->
                <!-- https://goodies.pixabay.com/javascript/auto-complete/auto-complete.js -->
                <script src="auto-complete.js"></script>
                <script>
                    function createAutoComplete(selector, algorithmID) {
	                     return new autoComplete({
	                        selector: selector,
	                        minChars: 1,
	                        source: function(term, response){
	                            persoo('send', 'suggest', {_w:'getAlgorithm', algorithmID: algorithmID, query: term},  function(data){ response(data.items); });
	                        },
	                        renderItem: function (item, search){
	                            search = search.replace(/[-\/\\^$*+?.()|[\]{}]/g, '\\$&');
	                            var re = new RegExp("(" + search.split(' ').join('|') + ")", "gi");
	                            return '<div class="autocomplete-suggestion" data-val="'+search+'"><img src="' + item.imageLink + '"> '+ item.title.replace(re, "<b>$1</b>") + '</div>';
	                        },
	                        onSelect: function(e, term, item){
	                            alert('Item "'+item.getAttribute('data-langname')+' ('+item.getAttribute('data-lang')+')" selected by '+(e.type == 'keydown' ? 'pressing enter' : 'mouse click')+'.');
	                        }
	                    });
                    }
                    
                    var myAutocomplete1 = createAutoComplete('input#demoAutocomplete1', 'd197a29af2394df2a36ccdd28a97196b');
                    var myAutocomplete2 = createAutoComplete('input#demoAutocomplete2', 'ac92c77e1c314a87810030a552d7a770');
                    var myAutocomplete3 = createAutoComplete('input#demoAutocomplete3', 'a53a90fb8ff24fb3bc7a19cce4281747');
                </script>
            </div>                
        </div>
    </div>
    <footer id="footerElement">

    </footer>
</body>
</html>
